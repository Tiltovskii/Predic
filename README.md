# Predic
**Predict CS:GO and Dota 2 matches**

Что за Predic?
------------------------------------

Predic - это мой небольшой проект, в котором я хотел получать предсказание результата матчей, чтобы в последствии ставить на них и выходить в плюс. В начале была создана модель на базе библиотеки ***catboost***, которая предсказывала "вероятность" победы какой-то из команд. Почему я выделил ***вероятность*** в кавычки будет пояснено дальше, когда я буду пояснять, как модель и данные устроены. В общем тогда модель мне не понравилась, и её следовало переделать, поэтому я решил вместо градиентного бустинга над деревьями использовать нейронные сети в надежде, что данных так много, что я смогу преодолеть предел классического машинного обучения.

<p align='center'>
  <img src='/photos/testrisk.jpg' height='256' width='512'/>
</p>

Но, к сожалению, этого не произошло. Тогда я подумал, что может в Dota 2 все лучше, так как читал статью от [Tongzhou Wang](https://ssnl.github.io/blog/neural-network-to-predict-dota-game-results/), где он утверждал, что добился ***accuracy в 70%***. И действительно, в Dota 2 модель работает лучше, хоть у меня и не получилось достичь результатов Tongzhou Wang.

Dota 2 модель
------------------------------------

### Сбор данных
Данные для модели я собирал с сайта [joint.com](https://www.joindota.com/matches/), на котором есть внушительная статистика по матчам, из которой можно узнать призовые команды, на каком они месте, их процент побед, их количество очков и т.д. Так же у них собраны все матчи с 2011 года включительно, да и сайт достаточно легкий и без капч, из-за чего парсинг можно провести очень быстро, если использовать ***aiohttp*** и ***asyncio***, что я и делал.

### Метрика
Метрику я решил выбрать стандартную: acсuracy, так как я нигде так и не смог найти, где можно пропарсить матчи и коэффициенты, которые на них были, благодаря чему можно было бы считать ROI или что-то похожее.

### Предобработка данных
Перед подачей данных в модель я использовал onehot encoder на игроках и героях. Заметив, что игроков в общей сложности вышло порядка 4700, а следовательно и onehot-вектор размера 1x4700, я решил уменьшить это число, использовав, [PCA](https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html) из scikit-learn, благодаря которому я взял 50 сингулярных чисел. PCA я так же использовал и над героями, так как ***accuracy*** особо не изменилось, а данных стало меньше. 

### Модель
Подбирать гиперпараметры особо я не увидел смысла (хоть и занимался этим продолжительное время), так как они сильно не меняли ***accuracy***.

Модель на выход выдает число от 0 или 1, которое показывает победит ли команда номер 1 (на сайте она расположена слева).

### Рузультаты
И что мы имеем в итоге от данной модели:
Probability | accuracy | ratio |
--- | --- | --- 
Probability ∈ (0, 1) | 65% | 100% |
Probability ∈ (0, 0.4) U (0.6, 1)| 70% | 60% |
Probability ∈ (0, 0.35) U (0.65, 1)| 75% | 40% |
Probability ∈ (0, 0.3) U (0.7, 1)| 78% | 28% |

 ### Как интерпретировать таблицу?

Наша модель может выдавать не только 1 либо 0, но и уверенность в этом с помощью команды ***predict_proba***, и если мы будет брать более уверенные результаты, то есть которые больше какого-то числа 0.5 + x либо меньше 0.5-x, где x ∈ [0, 0.5], то получим, что ***accuracy*** вырастет достаточно хорошо, но  мы теряем матчи и ***ratio*** показывает то, какой процент матчей мы будем теперь брать и ставить на них.

### Выводы

В принципе 40% матчей при доле верных ответов 0.75 для меня было бы сполна, но к сожалению нельзя посмотреть, какие все же коэффициенты на эти матчи, так как если они все 1.1, то вряд ли это окупится.

CS:GO модель
------------------------------------

